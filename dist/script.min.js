"use strict";function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(i,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}function _createClass(i,t,e){return t&&_defineProperties(i.prototype,t),e&&_defineProperties(i,e),i}var world=document.querySelector("#gameBoard"),canvas=document.getElementById("canvas"),score=document.getElementById("score"),days=document.getElementById("days"),endScreen=document.getElementById("endScreen"),c=world.getContext("2d");world.width=world.clientWidth,world.height=world.clientHeight;var frames=0,keys={ArrowLeft:{pessed:!1},ArrowRight:{pressed:!1},fired:{pressed:!1}},count=0;score.innerHTML=count;var intervalId=null,counter=60;function finish(){clearInterval(intervalId),document.getElementById("days").innerHTML="TERMINE!",clearInterval(intervalId)}function start(){intervalId=setInterval(bip,1e3)}days.innerHTML=counter,setInterval(function(){0==--counter?finish():document.getElementById("days").innerHTML=counter+" secondes restantes",counter=counter<=0?0:counter-0},1e3);var missiles,alienMissiles,grids,player,particules,lifes,Player=function(){function e(){var i=this;_classCallCheck(this,e),this.velocity={x:0,y:0};var t=new Image;t.src="./space.png",t.onload=function(){i.image=t,i.width=48,i.height=48,i.position={x:world.width/2-i.width/2,y:world.height-i.height-10}}}return _createClass(e,[{key:"draw",value:function(){c.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}},{key:"shoot",value:function(){missiles.push(new Missile({position:{x:this.position.x+this.width/2,y:this.position.y}}))}},{key:"update",value:function(){this.image&&(keys.ArrowLeft.pressed&&0<=this.position.x?this.velocity.x=-5:keys.ArrowRight.pressed&&this.position.x<=world.width-this.width?this.velocity.x=5:this.velocity.x=0,this.position.x+=this.velocity.x,this.draw())}}]),e}(),Alien=function(){function o(i){var t=this,e=i.position;_classCallCheck(this,o),this.velocity={x:0,y:0};var s=new Image;s.src="./ghost.png",s.onload=function(){t.image=s,t.width=32,t.height=32,t.position={x:e.x,y:e.y}}}return _createClass(o,[{key:"draw",value:function(){this.image&&c.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}},{key:"update",value:function(i){var t=i.velocity;this.image&&(this.position.x+=t.x,this.position.y+=t.y,this.position.y+this.height>=world.height&&console.log("You loose")),this.draw()}},{key:"shoot",value:function(i){this.position&&i.push(new alienMissile({position:{x:this.position.x,y:this.position.y},velocity:{x:0,y:3}}))}}]),o}(),Missile=function(){function e(i){var t=i.position;_classCallCheck(this,e),this.position=t,this.velocity={x:0,y:-5},this.width=3,this.height=10}return _createClass(e,[{key:"draw",value:function(){c.save(),c.fillStyle="red",c.fillRect(this.position.x,this.position.y,this.width,this.height),c.fill(),c.restore()}},{key:"update",value:function(){this.position.y+=this.velocity.y,this.draw()}}]),e}(),Grid=function(){function o(){_classCallCheck(this,o),this.position={x:0,y:0},this.velocity={x:1,y:0},this.invaders=[];var i=Math.floor(world.height/34*.2),t=Math.floor(world.width/34*.4);this.height=34*i,this.width=34*t;for(var e=0;e<t;e++)for(var s=0;s<i;s++)this.invaders.push(new Alien({position:{x:34*e,y:34*s}}))}return _createClass(o,[{key:"update",value:function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.velocity.y=0,(this.position.x+this.width>=world.width||0==this.position.x)&&(this.velocity.x=-this.velocity.x,this.velocity.y=34)}}]),o}(),Particule=function(){function n(i){var t=i.position,e=i.velocity,s=i.radius,o=i.color;_classCallCheck(this,n),this.position=t,this.velocity=e,this.radius=s,this.color=o,this.opacity=1}return _createClass(n,[{key:"draw",value:function(){c.save(),c.globalAlpha=this.opacity,c.beginPath(),c.fillStyle=this.color,c.arc(this.position.x,this.position.y,this.radius,0,2*Math.PI),c.fill(),c.closePath(),c.restore()}},{key:"update",value:function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,0<this.opacity&&(this.opacity-=.01),this.draw()}}]),n}(),alienMissile=function(){function s(i){var t=i.position,e=i.velocity;_classCallCheck(this,s),this.position=t,this.velocity=e,this.width=3,this.height=10}return _createClass(s,[{key:"draw",value:function(){c.save(),c.fillStyle="yellow",c.fillRect(this.position.x,this.position.y,this.width,this.height),c.fill(),c.restore()}},{key:"update",value:function(){this.draw(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}}]),s}(),init=function(){missiles=[],alienMissiles=[],grids=[new Grid],player=new Player,particules=[],lifes=3,keys.ArrowLeft.pressed=!1,keys.ArrowRight.pressed=!1,keys.fired.pressed=!1};init();var animationLoop=function i(){c.clearRect(0,0,world.width,world.height),player.update(),requestAnimationFrame(i),missiles.forEach(function(i,t){i.position.y+i.height<=0?setTimeout(function(){missiles.splice(t,1)},0):i.update()}),grids.forEach(function(n,r){n.update(),frames%50==0&&0<n.invaders.length&&n.invaders[Math.floor(Math.random()*n.invaders.length)].shoot(alienMissiles),n.invaders.forEach(function(s,o){s.update({velocity:n.velocity}),missiles.forEach(function(i,t){if(i.position.y<=s.position.y+s.height&&i.position.y>=s.position.y&&i.position.x+i.width>=s.position.x&&i.position.x-i.width<=s.position.x+s.width){for(var e=0;e<12;e++)particules.push(new Particule({position:{x:s.position.x+s.width/2,y:s.position.y+s.height/2},velocity:{x:2*(Math.random()-.5),y:2*(Math.random()-.5)},radius:5*Math.random()+1,color:"red"}));setTimeout(function(){n.invaders.splice(o,1),missiles.splice(t,1),count++,score.innerHTML=count,0===n.invaders.length&&1==grids.length&&(grids.splice(r,1),grids.push(new Grid))},0)}})})}),alienMissiles.forEach(function(i,t){if(i.position.y+i.height>=world.height?setTimeout(function(){alienMissiles.splice(t,1)},0):i.update(),i.position.y+i.height>=player.position.y&&i.position.y<=player.position.y+player.height&&i.position.x>=player.position.x&&i.position.x+i.width<=player.position.x+player.width){alienMissiles.splice(t,1);for(var e=0;e<22;e++)particules.push(new Particule({position:{x:player.position.x+player.width/2,y:player.position.y+player.height/2},velocity:{x:2*(Math.random()-.5),y:2*(Math.random()-.5)},radius:5*Math.random(),color:"white"}));lostLife()}}),particules.forEach(function(i,t){i.opacity<=0?particules.splice(t,1):i.update()}),frames++};animationLoop();var lostLife=function(){--lifes<=0&&(alert("perdu"),init())};addEventListener("keydown",function(i){switch(i.key){case"ArrowLeft":keys.ArrowLeft.pressed=!0;break;case"ArrowRight":keys.ArrowRight.pressed=!0}}),addEventListener("keyup",function(i){switch(i.key){case"ArrowLeft":keys.ArrowLeft.pressed=!1;break;case"ArrowRight":keys.ArrowRight.pressed=!1;break;case" ":player.shoot()}});
//# sourceMappingURL=script.min.js.map
